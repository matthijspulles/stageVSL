import numpy as np

Tref_m10_1 = np.array([
    -9.807134264,
    -9.791389483,
    -9.787515306,
    -9.791712886,
    -9.798054727,
    -9.783487892,
    -9.793804955,
    -9.789722434,
    -9.814550569,
])
Tu_m10_1 = np.array([
    -9.909895833,
    -9.887395833,
    -9.88,
    -9.888854167,
    -9.89,
    -9.88,
    -9.89,
    -9.8834,
    -9.91,
])


Tref_m10_2 = np.array([
    -9.840450597,
    -9.827561525,
    -9.819423531,
    -9.826992215,
    -9.820932088,
    -9.812904866,
    -9.815225835,
    -9.813648467,
    -9.832138865,
])
Tu_m10_2 = np.array([
    -9.9338,
    -9.9203,
    -9.9133,
    -9.92,
    -9.9194,
    -9.91,
    -9.91,
    -9.91,
    -9.9296,
])


Tref_1_1 = np.array([
    0.985762406,
    1.048034337,
    1.068779605,
    1.072852754,
    1.069131141,
    1.063208057,
    1.06735774,
    1.054076999,
    0.988700461,
])
Tu_1_1 = np.array([
    0.9496,
    1.0022,
    1.0258,
    1.03,
    1.0262,
    1.02,
    1.0207,
    1.01,
    0.95,
])


Tref_1_2 = np.array([
    1.020619134,
    1.068579343,
    1.071997645,
    1.068356576,
    1.072290444,
    1.066429435,
    1.069989054,
    1.065435902,
    1.020208195,
])
Tu_1_2 = np.array([
    0.97,
    1.0192,
    1.02,
    1.091,
    1.0082,
    1.0143,
    1.02,
    1.0112,
    0.97,
])


Tref_21_1 = np.array([
    20.87272359,
    20.97559445,
    21.01813866,
    21.02463403,
    21.03796182,
    21.03358712,
    21.01709112,
    20.97974284,
    20.88260527,
])
Tu_21_1 = np.array([
    20.85,
    20.95,
    20.99,
    21.0,
    21.01,
    21.0028,
    20.99,
    20.95,
    20.86,
])

Tref_21_2 = np.array([
    20.94439799,
    21.01104327,
    21.03077318,
    21.04157923,
    21.04880582,
    21.02533695,
    21.00990447,
    20.94242826,
])
Tu_21_2 = np.array([
    20.92,
    20.98,
    21.0,
    21.01,
    20.9819,
    20.9948,
    20.98,
    20.9102,
])

Tref_23_1 = np.array([
    22.91859802,
    23.00020555,
    23.01035692,
    23.02399072,
    23.02869976,
    23.02192158,
    23.01389414,
    22.99950505,
    22.92321477,
])
Tu_23_1 = np.array([
    22.8908,
    22.9697,
    22.98,
    22.99,
    22.96,
    22.99,
    22.9815,
    22.97,
    22.9,
])


Tref_23_2 = np.array([
    22.87218721,
    22.97709606,
    23.02393423,
    23.03390027,
    23.04000328,
    23.03155177,
    23.0209085,
    22.98203745,
    22.88397886,
])
Tu_23_2 = np.array([
    22.85,
    22.951,
    23.0,
    23.01,
    23.014,
    23.006,
    22.992,
    22.951,
    22.86,
])


Tref_50_1 = np.array([
    49.8112915,
    49.96418985,
    49.99541441,
    50.01305397,
    50.05599994,
    50.01149372,
    49.99405405,
    49.96770612,
    49.81889843,
])
Tu_50_1 = np.array([
    49.81,
    49.96,
    49.99,
    49.99,
    49.96,
    49.9919,
    49.9813,
    49.96,
    49.8135,
])

Tref_50_2 = np.array([
    49.75743804,
    49.9248281,
    49.97834503,
    49.99235014,
    50.01793756,
    49.98518243,
    49.97452309,
    49.92294831,
    49.74173449,
])
Tu_50_2 = np.array([
    49.7702,
    49.9296,
    49.98,
    49.99,
    50.0196,
    49.9824,
    49.9708,
    49.9224,
    49.7531,
])

Tref_85_1 = np.array([
    84.6269334,
    84.82787339,
    84.89106532,
    84.90649553,
    84.91821955,
    84.90195442,
    84.90373523,
    84.8340411,
    84.59669503,
])
Tu_85_1 = np.array([
    84.6266,
    84.8162,
    84.8707,
    84.8924,
    84.8986,
    84.8728,
    84.8824,
    84.819,
    84.6139,
])

Tref_85_2 = np.array([
    84.76941624,
    84.89514387,
    84.91890053,
    84.92588891,
    84.94305714,
    84.91248674,
    84.9086517,
    84.89159941,
    84.76812209,
])
Tu_85_2 = np.array([
    84.69,
    84.8373,
    84.8585,
    84.8382,
    84.6666,
    84.8298,
    84.85,
    84.83,
    84.6869,
])


T_ref_all = np.concatenate([
    Tref_m10_1, Tref_m10_2,
    Tref_1_1,   Tref_1_2,
    Tref_21_1,  Tref_21_2,
    Tref_23_1,  Tref_23_2,
    Tref_50_1,  Tref_50_2,
    Tref_85_1,  Tref_85_2,
])
T_uut_all = np.concatenate([
    Tu_m10_1, Tu_m10_2,
    Tu_1_1,   Tu_1_2,
    Tu_21_1,  Tu_21_2,
    Tu_23_1,  Tu_23_2,
    Tu_50_1,  Tu_50_2,
    Tu_85_1,  Tu_85_2,
])


# Polynoom fitten: T_uut = c0 + c1*T_ref + c2*T_ref^2

poly_order = 2
c2, c1, c0 = np.polyfit(T_ref_all, T_uut_all, poly_order)
coeffs_T = np.array([c0, c1, c2])

print("Polynoomecoëfficiënten (T_uut = c0 + c1*T_ref + c2*T_ref^2):")
print(f"  c0 = {c0}")
print(f"  c1 = {c1}")
print(f"  c2 = {c2}")


def T_uut_from_ref(T_ref):
    """Bereken T_UUT uit T_ref met de fit."""
    c0, c1, c2 = coeffs_T
    T_ref = np.asarray(T_ref)
    return c0 + c1*T_ref + c2*T_ref**2


T_grid = np.array([-10.0, -9.0, 1.0, 21.0, 23.0, 50.0, 70.0, 85.0])
T_uut_grid = T_uut_from_ref(T_grid)

for Tr, Tu in zip(T_grid, T_uut_grid):
    print(f"  T_ref = {Tr} °C  ->  T_UUT(model) ≈ {Tu} °C")



