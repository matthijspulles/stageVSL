import numpy as np

# -10
x = np.array([
    -9.80713, -9.79139, -9.78752, -9.79171, -9.79805,
    -9.78349, -9.79380, -9.78972, -9.81455,
    -9.84045, -9.82756, -9.81942, -9.82699, -9.82093,
    -9.81290, -9.81523, -9.81365, -9.83214
])

y = np.array([
    -9.88593, -9.88593, -9.88593, -9.88593, -9.88593,
    -9.88593, -9.88593, -9.88593, -9.88593,
    -9.91724, -9.91724, -9.91724, -9.91724, -9.91724,
    -9.91724, -9.91724, -9.91724, -9.91724
])

a, b = np.polyfit(x, y, 1)
y_fit = a * x + b
res = y - y_fit
u_fit_min10 = np.sqrt(np.sum(res**2) / (len(x) - 2))


# 1
x = np.array([
    0.985762, 1.048034, 1.06878, 1.072853, 1.069131,
    1.063208, 1.067358, 1.054077, 0.9887
])

y = np.array([
    1.00427, 1.00427, 1.00427, 1.00427, 1.00427,
    1.00427, 1.00427, 1.00427, 1.00427
])

a, b = np.polyfit(x, y, 1)
y_fit = a * x + b
res = y - y_fit
u_fit_1 = np.sqrt(np.sum(res**2) / (len(x) - 2))

# 21
x = np.array([
    20.87272, 20.97559, 21.01814, 21.02463, 21.03796,
    21.03359, 21.01709, 20.97974, 20.88261
])

y = np.array([
    20.94382, 20.94382, 20.94382, 20.94382, 20.94382,
    20.94382, 20.94382, 20.94382, 20.94382
])

a, b = np.polyfit(x, y, 1)
y_fit = a * x + b
res = y - y_fit
u_fit_21 = np.sqrt(np.sum(res**2) / (len(x) - 2))

# 23
x = np.array([
    22.9186, 23.00021, 23.01036, 23.02399, 23.0287,
    23.02192, 23.01389, 22.99951, 22.92321,
    22.87219, 22.9771, 23.02393, 23.0339, 23.04,
    23.03155, 23.02091, 22.98204, 22.88398
])

y = np.array([
    22.95909, 22.95909, 22.95909, 22.95909, 22.95909,
    22.95909, 22.95909, 22.95909, 22.95909,
    22.97644, 22.97644, 22.97644, 22.97644, 22.97644,
    22.97644, 22.97644, 22.97644, 22.97644
])

a, b = np.polyfit(x, y, 1)
y_fit = a * x + b
res = y - y_fit
u_fit_23 = np.sqrt(np.sum(res**2) / (len(x) - 2))

# 50
x = np.array([
    49.81129, 49.96419, 49.99541, 50.01305, 50.056,
    50.01149, 49.99405, 49.96771, 49.8189,
    49.75744, 49.92883, 49.97935, 49.99235, 50.01749,
    49.98518, 49.97452, 49.92255, 49.74173
])

y = np.array([
    49.96045, 49.96045, 49.96045, 49.96045, 49.96045,
    49.96045, 49.96045, 49.96045, 49.96045,
    49.9443, 49.9443, 49.9443, 49.9443, 49.9443,
    49.9443, 49.9443, 49.9443, 49.9443
])

a, b = np.polyfit(x, y, 1)
y_fit = a * x + b
res = y - y_fit
u_fit_50 = np.sqrt(np.sum(res**2) / (len(x) - 2))

# 85
x = np.array([
    84.62693, 84.82787, 84.89107, 84.9065, 84.91822,
    84.90195, 84.90374, 84.83004, 84.5967,
    84.76942, 84.89514, 84.9189, 84.92589, 84.94306,
    84.91249, 84.90865, 84.90299, 84.76812
])

y = np.array([
    84.81268, 84.81268, 84.81268, 84.81268, 84.81268,
    84.81268, 84.81268, 84.81268, 84.81268,
    84.79687, 84.79687, 84.79687, 84.79687, 84.79687,
    84.79687, 84.79687, 84.79687, 84.79687
])

a, b = np.polyfit(x, y, 1)
y_fit = a * x + b
res = y - y_fit
u_fit_85 = np.sqrt(np.sum(res**2) / (len(x) - 2))

print(f"-10 °C : {u_fit_min10f} %RH")
print(f"  1 °C : {u_fit_1} %RH")
print(f" 21 °C : {u_fit_21} %RH")
print(f" 23 °C : {u_fit_23} %RH")
print(f" 50 °C : {u_fit_50} %RH")
print(f" 85 °C : {u_fit_85} %RH")